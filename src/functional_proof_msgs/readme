Functional-style transitions written using `proof` functions.
Now with messages!